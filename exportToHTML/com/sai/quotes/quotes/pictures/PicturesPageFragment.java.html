<html>
<head>
<title>PicturesPageFragment.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #606366; font-weight: normal; font-style: normal; }
.s0 { color: rgb(128,128,128); }
.s1 { color: rgb(169,183,198); }
.s2 { color: rgb(204,120,50); }
.s3 { color: rgb(98,151,85); font-style: italic; }
.s4 { color: rgb(119,183,103); font-style: italic; }
.s5 { color: rgb(106,135,89); }
.s6 { color: rgb(98,151,85); font-weight: bold; font-style: italic; }
.s7 { color: rgb(104,151,187); }
</style>
</head>
<BODY BGCOLOR="#2b2b2b">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
PicturesPageFragment.java</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">/* 
 * Copyright 2012 The Android Open Source Project 
 * 
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); 
 * you may not use this file except in compliance with the License. 
 * You may obtain a copy of the License at 
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0 
 * 
 * Unless required by applicable law or agreed to in writing, software 
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS, 
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. 
 * See the License for the specific language governing permissions and 
 * limitations under the License. 
 */</span><span class="s1"> 
 
</span><span class="s2">package </span><span class="s1">com.sai.quotes.quotes.pictures</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">android.content.Context</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.content.SharedPreferences</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.graphics.Bitmap</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.os.Bundle</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.support.design.widget.BottomSheetBehavior</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.support.v4.app.Fragment</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.util.Log</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.view.LayoutInflater</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.view.View</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.view.ViewGroup</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.ImageView</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.ProgressBar</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.TextView</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">android.widget.Toast</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">com.google.gson.Gson</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.google.gson.reflect.TypeToken</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.nostra13.universalimageloader.core.DisplayImageOptions</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.nostra13.universalimageloader.core.ImageLoader</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.nostra13.universalimageloader.core.ImageLoaderConfiguration</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.nostra13.universalimageloader.core.assist.FailReason</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.nostra13.universalimageloader.core.listener.ImageLoadingListener</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.nostra13.universalimageloader.core.listener.ImageLoadingProgressListener</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.sai.quotes.quotes.R</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.squareup.picasso.Callback</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.squareup.picasso.Picasso</span><span class="s2">;</span><span class="s1"> 
</span><span class="s2">import </span><span class="s1">com.squareup.picasso.Transformation</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s2">import </span><span class="s1">java.util.ArrayList</span><span class="s2">;</span><span class="s1"> 
 
</span><span class="s3">/** 
 * A fragment representing a single step in a wizard. The fragment shows a dummy title indicating 
 * the page number, along with some dummy text. 
 * </span><span class="s4">&lt;p&gt;</span><span class="s3"> 
 * ScreenSlideActivity} samples.</span><span class="s4">&lt;/p&gt;</span><span class="s3"> 
 */</span><span class="s1"> 
</span><span class="s2">public class </span><span class="s1">PicturesPageFragment </span><span class="s2">extends </span><span class="s1">Fragment { 
 
 
    </span><span class="s2">private </span><span class="s1">ArrayList&lt;String&gt; student</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">TextView quotesLargeTV</span><span class="s2">, </span><span class="s1">currentItemValue</span><span class="s2">, </span><span class="s1">errloading</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">View controlsView</span><span class="s2">;</span><span class="s1"> 
    ImageView heartWhite</span><span class="s2">, </span><span class="s1">heartRed</span><span class="s2">, </span><span class="s1">shareImg</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">SharedPreferences.Editor editor</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">SharedPreferences sharedPreferences</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">String selectedarray</span><span class="s2">;</span><span class="s1"> 
    </span><span class="s2">private </span><span class="s1">ArrayList&lt;String&gt; favouritearraySP</span><span class="s2">;</span><span class="s1"> 
    BottomSheetBehavior mBottomSheetBehavior1</span><span class="s2">;</span><span class="s1"> 
    ProgressBar loadingPG</span><span class="s2">;</span><span class="s1"> 
 
 
    </span><span class="s3">/** 
     * The argument key for the page number this fragment represents. 
     */</span><span class="s1"> 
    </span><span class="s2">public static final </span><span class="s1">String ARG_PAGE = </span><span class="s5">&quot;page&quot;</span><span class="s2">;</span><span class="s1"> 
 
    </span><span class="s3">/** 
     * The fragment's page number, which is set to the argument value for {</span><span class="s6">@link </span><span class="s3">#ARG_PAGE}. 
     */</span><span class="s1"> 
    </span><span class="s2">private int </span><span class="s1">mPageNumber</span><span class="s2">;</span><span class="s1"> 
    ArrayList&lt;PicturesPOJO&gt; ifsendarr</span><span class="s2">;</span><span class="s1"> 
 
    </span><span class="s3">/** 
     * Factory method for this fragment class. Constructs a new fragment for the given page number. 
     */</span><span class="s1"> 
    </span><span class="s2">public static </span><span class="s1">PicturesPageFragment create(</span><span class="s2">int </span><span class="s1">pageNumber) { 
        PicturesPageFragment fragment = </span><span class="s2">new </span><span class="s1">PicturesPageFragment()</span><span class="s2">;</span><span class="s1"> 
        Bundle args = </span><span class="s2">new </span><span class="s1">Bundle()</span><span class="s2">;</span><span class="s1"> 
        args.putInt(ARG_PAGE</span><span class="s2">, </span><span class="s1">pageNumber)</span><span class="s2">;</span><span class="s1"> 
</span><span class="s0">//        args.putString(&quot;dummy_array&quot;,ifsendarr);</span><span class="s1"> 
        fragment.setArguments(args)</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">return </span><span class="s1">fragment</span><span class="s2">;</span><span class="s1"> 
    } 
 
    </span><span class="s2">public </span><span class="s1">PicturesPageFragment() { 
    } 
 
    @Override 
    </span><span class="s2">public void </span><span class="s1">onCreate(Bundle savedInstanceState) { 
        </span><span class="s2">super</span><span class="s1">.onCreate(savedInstanceState)</span><span class="s2">;</span><span class="s1"> 
        mPageNumber = getArguments().getInt(ARG_PAGE)</span><span class="s2">;</span><span class="s1"> 
    } 
 
    @Override 
    </span><span class="s2">public </span><span class="s1">View onCreateView(LayoutInflater inflater</span><span class="s2">, </span><span class="s1">ViewGroup container</span><span class="s2">,</span><span class="s1"> 
                             Bundle savedInstanceState) { 
 
 
        sharedPreferences = getContext().getSharedPreferences(</span><span class="s5">&quot;mypreference&quot;</span><span class="s2">, </span><span class="s1">Context.MODE_PRIVATE)</span><span class="s2">;</span><span class="s1"> 
        editor = sharedPreferences.edit()</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s0">//Get to SharedPreferences</span><span class="s1"> 
        Gson gson = </span><span class="s2">new </span><span class="s1">Gson()</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s0">//For default value, just to get no errors while getting no value from the SharedPreferences</span><span class="s1"> 
        String empty_list = gson.toJson(</span><span class="s2">new </span><span class="s1">ArrayList&lt;PicturesPOJO&gt;())</span><span class="s2">;</span><span class="s1"> 
 
        ArrayList&lt;PicturesPOJO&gt; selectedPOJO = gson.fromJson(sharedPreferences.getString(</span><span class="s5">&quot;selectedarray&quot;</span><span class="s2">, </span><span class="s1">empty_list)</span><span class="s2">,</span><span class="s1"> 
                </span><span class="s2">new </span><span class="s1">TypeToken&lt;ArrayList&lt;PicturesPOJO&gt;&gt;() { 
                }.getType())</span><span class="s2">;</span><span class="s1"> 
 
 
        </span><span class="s0">// Inflate the layout containing a title and body text.</span><span class="s1"> 
        </span><span class="s2">final </span><span class="s1">ViewGroup rootView = (ViewGroup) inflater 
                .inflate(R.layout.picture_screen_layout</span><span class="s2">, </span><span class="s1">container</span><span class="s2">, false</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">final </span><span class="s1">ImageView imageView = (ImageView) rootView.findViewById(R.id.pictures_IV)</span><span class="s2">;</span><span class="s1"> 
        TextView headingTV = (TextView) rootView.findViewById(R.id.pictures_headingTV)</span><span class="s2">;</span><span class="s1"> 
        TextView bodyTV = (TextView) rootView.findViewById(R.id.pictures_bodyTV)</span><span class="s2">;</span><span class="s1"> 
        currentItemValue = (TextView) rootView.findViewById(R.id.current_Item_value)</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s2">final </span><span class="s1">View bottomSheet = rootView.findViewById(R.id.bottom_sheet1)</span><span class="s2">;</span><span class="s1"> 
        errloading = (TextView) rootView.findViewById(R.id.err_txt)</span><span class="s2">;</span><span class="s1"> 
        loadingPG = (ProgressBar) rootView.findViewById(R.id.laoding_pg)</span><span class="s2">;</span><span class="s1"> 
 
 
        </span><span class="s0">// Create global configuration and initialize ImageLoader with this config</span><span class="s1"> 
        ImageLoaderConfiguration config = </span><span class="s2">new </span><span class="s1">ImageLoaderConfiguration.Builder(getActivity()).build()</span><span class="s2">;</span><span class="s1"> 
        ImageLoader imageLoader = ImageLoader.getInstance()</span><span class="s2">;</span><span class="s1"> 
        imageLoader.init(ImageLoaderConfiguration.createDefault(getContext()))</span><span class="s2">;</span><span class="s1"> 
 
        DisplayImageOptions options = </span><span class="s2">new </span><span class="s1">DisplayImageOptions.Builder() 
                .cacheInMemory(</span><span class="s2">true</span><span class="s1">).showImageOnFail(android.R.drawable.stat_notify_error) 
                .showImageOnFail(android.R.drawable.stat_notify_error) 
                .showImageOnLoading(android.R.drawable.stat_notify_error).cacheOnDisc(</span><span class="s2">true</span><span class="s1">) 
                .bitmapConfig(Bitmap.Config.RGB_565).build()</span><span class="s2">;</span><span class="s1"> 
        </span><span class="s0">// Load image, decode it to Bitmap and display Bitmap in ImageView (or any other view</span><span class="s1"> 
</span><span class="s0">//  which implements ImageAware interface)</span><span class="s1"> 
        imageLoader.displayImage(selectedPOJO.get(mPageNumber).getUrl()</span><span class="s2">, </span><span class="s1">imageView</span><span class="s2">, </span><span class="s1">options</span><span class="s2">, new </span><span class="s1">ImageLoadingListener() { 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onLoadingStarted(String imageUri</span><span class="s2">, </span><span class="s1">View view) { 
loadingPG.setVisibility(View.VISIBLE)</span><span class="s2">;</span><span class="s1"> 
            } 
 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onLoadingFailed(String imageUri</span><span class="s2">, </span><span class="s1">View view</span><span class="s2">, </span><span class="s1">FailReason failReason) { 
                errloading.setVisibility(View.VISIBLE)</span><span class="s2">;</span><span class="s1"> 
            } 
 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onLoadingComplete(String imageUri</span><span class="s2">, </span><span class="s1">View view</span><span class="s2">, </span><span class="s1">Bitmap loadedImage) { 
                loadingPG.setVisibility(View.GONE)</span><span class="s2">;</span><span class="s1"> 
            } 
 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onLoadingCancelled(String imageUri</span><span class="s2">, </span><span class="s1">View view) { 
 
            } 
        }</span><span class="s2">, new </span><span class="s1">ImageLoadingProgressListener() { 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onProgressUpdate(String imageUri</span><span class="s2">, </span><span class="s1">View view</span><span class="s2">, int </span><span class="s1">current</span><span class="s2">, int </span><span class="s1">total) { 
            } 
        })</span><span class="s2">;</span><span class="s1"> 
 
 
        imageLoader.displayImage(selectedPOJO.get(mPageNumber).getUrl()</span><span class="s2">, </span><span class="s1">imageView)</span><span class="s2">;</span><span class="s1"> 
 
 
 
 
      </span><span class="s0">/*  Transformation transformation = new Transformation() { 
 
            @Override 
            public Bitmap transform(Bitmap source) { 
                int targetWidth = 500; 
 
                double aspectRatio = (double) source.getHeight() / (double) source.getWidth(); 
                int targetHeight = (int) (targetWidth * aspectRatio); 
                Bitmap result = Bitmap.createScaledBitmap(source, targetWidth, targetHeight, false); 
                if (result != source) { 
                    // Same bitmap is returned if sizes are the same 
                    source.recycle(); 
                } 
                return result; 
            } 
 
            @Override 
            public String key() { 
                return &quot;transformation&quot; + &quot; desiredWidth&quot;; 
            } 
        }; 
 
//        mMessage_pic_url = message_pic_url; 
 
        Picasso.with(getContext()) 
                .load(selectedPOJO.get(mPageNumber).getUrl()) 
                .error(android.R.drawable.stat_notify_error) 
                .transform(transformation) 
                .into(imageView, new Callback() { 
                    @Override 
                    public void onSuccess() { 
                        bottomSheet.setVisibility(View.VISIBLE); 
//                        holder.progressBar_picture.setVisibility(View.GONE); 
                        Toast.makeText(getContext(),&quot;onsucess&quot;,Toast.LENGTH_SHORT).show(); 
                    } 
 
                    @Override 
                    public void onError() { 
                        bottomSheet.setVisibility(View.GONE); 
                        Toast.makeText(getContext(),&quot;onerror&quot;,Toast.LENGTH_SHORT).show(); 
                        Log.e(&quot;picasoerror&quot;, &quot;error&quot;); 
//                        holder.progressBar_picture.setVisibility(View.GONE); 
                    } 
                }); 
*/</span><span class="s1"> 
 
 
</span><span class="s0">//        Picasso.with(getContext())</span><span class="s1"> 
</span><span class="s0">//                .load(selectedPOJO.get(mPageNumber).getUrl())</span><span class="s1"> 
</span><span class="s0">//                .into(imageView);</span><span class="s1"> 
</span><span class="s0">//        Picasso.with(getContext()).setLoggingEnabled(true);</span><span class="s1"> 
        headingTV.setText(selectedPOJO.get(mPageNumber).getHeading())</span><span class="s2">;</span><span class="s1"> 
        bodyTV.setText(selectedPOJO.get(mPageNumber).getBody())</span><span class="s2">;</span><span class="s1"> 
</span><span class="s0">//        quotesLargeTV.setText(&quot;\&quot;&quot; + selctedarrayitems.get(mPageNumber).toString() + &quot;\&quot;&quot;);</span><span class="s1"> 
        currentItemValue.setText(mPageNumber + </span><span class="s7">1 </span><span class="s1">+ </span><span class="s5">&quot;/&quot; </span><span class="s1">+ String.valueOf(selectedPOJO.size()))</span><span class="s2">;</span><span class="s1"> 
        mBottomSheetBehavior1 = BottomSheetBehavior.from(bottomSheet)</span><span class="s2">;</span><span class="s1"> 
        mBottomSheetBehavior1.setState(BottomSheetBehavior.STATE_COLLAPSED)</span><span class="s2">;</span><span class="s1"> 
        mBottomSheetBehavior1.setPeekHeight(</span><span class="s7">100</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
        rootView.findViewById(R.id.pictures_IV).setOnClickListener(</span><span class="s2">new </span><span class="s1">View.OnClickListener() { 
            @Override 
            </span><span class="s2">public void </span><span class="s1">onClick(View v) { 
 
                bottomSheet.post(</span><span class="s2">new </span><span class="s1">Runnable() { 
                    @Override 
                    </span><span class="s2">public void </span><span class="s1">run() { 
                        </span><span class="s2">if </span><span class="s1">(mBottomSheetBehavior1.getState() != BottomSheetBehavior.STATE_EXPANDED) { 
                            mBottomSheetBehavior1.setPeekHeight(</span><span class="s7">100</span><span class="s1">)</span><span class="s2">;</span><span class="s1"> 
                            mBottomSheetBehavior1.setState(BottomSheetBehavior.STATE_EXPANDED)</span><span class="s2">;</span><span class="s1"> 
                        } </span><span class="s2">else </span><span class="s1">{ 
                            mBottomSheetBehavior1.setState(BottomSheetBehavior.STATE_COLLAPSED)</span><span class="s2">;</span><span class="s1"> 
                        } 
</span><span class="s0">//                        mBottomSheetBehavior1.setPeekHeight(100);</span><span class="s1"> 
</span><span class="s0">//                        mBottomSheetBehavior1.setState(BottomSheetBehavior.STATE_EXPANDED);</span><span class="s1"> 
                    } 
                })</span><span class="s2">;</span><span class="s1"> 
            } 
        })</span><span class="s2">;</span><span class="s1"> 
 
        </span><span class="s2">return </span><span class="s1">rootView</span><span class="s2">;</span><span class="s1"> 
    } 
 
    </span><span class="s3">/** 
     * Returns the page number represented by this fragment object. 
     */</span><span class="s1"> 
    </span><span class="s2">public int </span><span class="s1">getPageNumber() { 
        </span><span class="s2">return </span><span class="s1">mPageNumber</span><span class="s2">;</span><span class="s1"> 
    } 
} 
</span></pre>
</body>
</html>